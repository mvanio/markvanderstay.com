{
  "hash": "2244c6f9bd2878ad972fa7c30931f187",
  "result": {
    "markdown": "---\ntitle: \"Customer Lifetime Value Analysis with CLVTools\"\nauthor: \"Your Name\"\ndate: \"2023-04-19\"\noutput: quarto::html_document\n---\n\n\n\n# **Introduction**\n\nIn this document, we will demonstrate how to analyze customer transaction data using the CLVTools package in R. The CLVTools package provides tools for Customer Lifetime Value (CLV) analysis, which can help businesses make better decisions about customer acquisition, retention, and marketing.\n\nOur analysis will focus on two statistical models commonly used for CLV estimation in non-contractual settings: the Pareto/NBD model, which models customer churn and purchase frequency, and the Gamma-Gamma model, which models customer spending. We will also explore how to incorporate static and dynamic covariates, regularization, and constraints into these models.\n\nThis document is aimed at data scientists who have a basic understanding of R and are interested in learning more about CLV analysis.\n\n```         \n{r}\n\nlibrary(CLVTools)\n```\n\n# **Data Preparation**\n\nWe will use the example dataset of transactions for an apparel company provided by the CLVTools package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"apparelTrans\")\n```\n:::\n\nFirst, we create a CLV data object, specifying the format of the date, time unit, estimation split, and ID column. We set the estimation split at 39 weeks to divide the data into calibration and holdout periods, which allows us to evaluate the predictive performance of our models.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclv.apparel <- clvdata(data.transactions = apparelTrans, date.format = \"ymd\",\n                          time.unit = \"week\", estimation.split = 39, name.id = \"Id\")\n```\n:::\n\n\n# **Pareto/NBD Model**\n\nThe Pareto/NBD model is a widely-used model for non-contractual settings because it accounts for customer heterogeneity in both purchase frequency and churn behavior. The starting parameter values (r=0.5, alpha=8, s=0.5, beta=10) are arbitrary and should be adjusted based on the specific dataset and domain knowledge.\n\n```         \n{r}\n\npnbd.apparel <- pnbd(clv.apparel,\n                   start.params.model = c(r=0.5, alpha=8, s=0.5, beta=10))\n``` \n\n# **Gamma-Gamma Model**\n\nThe Gamma-Gamma model is designed to model monetary value in the presence of customer heterogeneity and is well-suited for non-contractual settings. The model is typically used in conjunction with the Pareto/NBD model to estimate CLV.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nest.gg <- gg(clv.data = clv.apparel)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nStarting estimation...\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nEstimation finished!\n```\n:::\n:::\n\n# **Incorporating Covariates**\n\nWe can improve the predictive performance of our models by incorporating additional information about customers, such as demographics or acquisition channels. Here, we demonstrate how to add static and dynamic covariates to the CLV data object.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"apparelStaticCov\")\ndata(\"apparelDynCov\")\n\nclv.static <- SetStaticCovariates(clv.data = clv.apparel,\n                                 data.cov.life = apparelStaticCov,\n                                 data.cov.trans = apparelStaticCov,\n                                 names.cov.life = c(\"Gender\", \"Channel\"),\n                                 names.cov.trans =c(\"Gender\", \"Channel\"),\n                                 name.id = \"Id\")\n\nclv.dyn <- SetDynamicCovariates(clv.data = clv.apparel,\n                                data.cov.life = apparelDynCov,\n                                data.cov.trans = apparelDynCov,\n                                names.cov.life = c(\"Marketing\", \"Gender\", \"Channel\"),\n                                names.cov.trans = c(\"Marketing\", \"Gender\", \"Channel\"),\nname.id = \"Id\",\nname.date = \"Cov.Date\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nThe Lifetime covariate data before 2005-01-02 (period of estimation start) is cut off.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe Transaction covariate data before 2005-01-02 (period of estimation start) is cut off.\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Model with Static Covariates\n\n# We estimate the Pareto/NBD model with static covariates to incorporate the additional information about customers. The starting parameter values for the life and transaction components (Gender=0.6, Channel=0.4) are arbitrary and should be adjusted based on the specific dataset and domain knowledge.\n\n\nest.pnbd.static <- pnbd(clv.static,\n                        start.params.model = c(r=1, alpha = 2, s = 1, beta = 2),\n                        start.params.life = c(Gender=0.6, Channel=0.4),\n                        start.params.trans = c(Gender=0.6, Channel=0.4))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nStarting estimation...\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nEstimation finished!\n```\n:::\n:::\n\n\n# **Model with Regularization**\n\nWe estimate the Pareto/NBD model with regularization to prevent overfitting and improve model stability, particularly when the number of covariates is large or the sample size is small. The regularization parameters (trans=100, life=100) control the strength of the regularization penalty and should be chosen through a process like cross-validation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nest.pnbd.reg <- pnbd(clv.static,\n                     start.params.model = c(r=1, alpha = 2, s = 1, beta = 2),\n                     reg.lambdas = c(trans=100, life=100))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nStarting estimation...\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nEstimation finished!\n```\n:::\n:::\n\n\n# **Model with Constraints**\n\nWe estimate the Pareto/NBD model with constraints to impose certain relationships between covariates and outcomes, which can be based on domain knowledge or to improve model interpretability. The constraint parameter (Gender=0.6) is chosen to impose a specific relationship between gender and outcomes.\n\n```         \n{rCopy code\n```\n\n`est.pnbd.constr <- pnbd(clv.static,\n                        start.params.model = c(r=1, alpha = 2, s = 1, beta = 2),\n                        start.params.constr = c(Gender=0.6),\n                        names.cov.constr=c(\"Gender\"))`\n\n# **Predictions**\n\nWe can use our fitted models to generate predictions for future transactions and spending. Here, we demonstrate how to predict future spending using the Gamma-Gamma model.\n\n```         \n{rCopy code\n```\n\n`results.spending <- predict(est.gg)\nprint(results.spending)`\n\n# **Conclusion**\n\nThis document has demonstrated how to analyze customer transaction data with the CLVTools package in R, focusing on the Pareto/NBD and Gamma-Gamma models for non-contractual settings. We have also explored incorporating static and dynamic covariates, regularization, and constraints into these models.\n\nCustomer Lifetime Value analysis is an important tool for businesses to make informed decisions about customer acquisition, retention, and marketing. With a solid understanding of CLV analysis techniques, data scientists can help businesses optimize their strategies and maximize profits.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}